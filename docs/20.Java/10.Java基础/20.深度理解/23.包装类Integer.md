# åŒ…è£…ç±»Integeråˆ›å»ºå¯¹è±¡

## 1 æµ‹è¯•
å…ˆçœ‹çœ‹ä¸‹é¢çš„æµ‹è¯•ï¼š

ğŸ”¶ **æµ‹è¯•1**
```java
@Test
public void test1() {
    Integer i1 = 1;
    Integer i2 = 1;
    System.out.println(i1 == i2);  // true

    Integer i3 = new Integer(1);
    Integer i4 = new Integer(1);
    System.out.println(i3 == i4);  // false
	
	Integer i5 = Integer.valueOf(1);
    Integer i6 = Integer.valueOf(1);
    System.out.println(i5 == i6);  // true
    
    Integer i9 = Integer.valueOf(1111);
    Integer i10 = Integer.valueOf(1111);
    System.out.println(i9 == i10);  // false
    
    Integer i11 = 1111;
    Integer i12 = 1111;
    System.out.println(i11 == i12);  // false
    
    int i7 = 1;
    int i8 = 1;
    System.out.println(i7 == i8);  // true
}
```

ğŸ”¶ **æµ‹è¯•2**

```java
@Test
public void test2() {
    int i1 = 1;
    Integer i2 = 1;
    Integer i3 = new Integer(1);
    Integer i4 = Integer.valueOf(1);

    System.out.println(i1 == i2);  // true
    System.out.println(i1 == i3);  // true
    System.out.println(i1 == i4);  // true
    System.out.println(i2 == i3);  // false
    System.out.println(i2 == i4);  // true
    System.out.println(i3 == i4);  // false
}
```
## 2 è§£é‡Š
### ğŸ”¸ int i = 1
```java
@Test
public void test4() {
    int i1 = 1;
    int i2 = 1;
    int i3 = 1;

    System.out.println(i1 == i2);  // true
    System.out.println(i1 == i3);  // true
    System.out.println(i2 == i3);  // true
}
```
å†…å­˜ä¸­æ˜¯è¿™æ ·çš„
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://raw.githubusercontent.com/zouquchen/Images/main/imgs/7aed34e2a66f4086924e9ac24e239232.png)

### ğŸ”¸ Integer i = new Integer(1)

`Integer i = new Integer(1)` æ¯æ¬¡éƒ½ä¼šæ–°å»ºä¸€ä¸ªå¯¹è±¡ã€‚

```java
@Test
public void test3() {
    Integer i1 = new Integer(1);
    Integer i2 = new Integer(1);
    Integer i3 = new Integer(1);

    System.out.println(i1 == i2);  // false
    System.out.println(i1 == i3);  // false
    System.out.println(i2 == i3);  // false
}
```

å†…å­˜ä¸­æ˜¯è¿™æ ·ï¼Œi1 i2 i3æ˜¯3ä¸ªä¸åŒçš„å¯¹è±¡ã€‚
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://raw.githubusercontent.com/zouquchen/Images/main/imgs/7834f23e6f7544abb555621c2f046ce1.png)
### ğŸ”¸ Integer.valueOf(1)
`Integer.valueOf(1)` ä¼šä½¿ç”¨ç¼“å­˜æ± ä¸­çš„å¯¹è±¡ï¼Œå¤šæ¬¡è°ƒç”¨ä¼šå–å¾—åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚

```java
@Test
public void test5() {
    Integer i1 = Integer.valueOf(1);
    Integer i2 = Integer.valueOf(1);
    Integer i3 = Integer.valueOf(1);

    System.out.println(i1 == i2);  // true
    System.out.println(i1 == i3);  // true
    System.out.println(i2 == i3);  // true
}
```
å†…å­˜ä¸­æ˜¯è¿™æ ·ï¼Œi1 i2 i3æ˜¯3ä¸ªç›¸åŒçš„å¯¹è±¡ã€‚
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://raw.githubusercontent.com/zouquchen/Images/main/imgs/0a6c5d477e8a49baa33e94f3b2808eef.png)
`valueOf()`æ–¹æ³•çš„å®ç°æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯å…ˆåˆ¤æ–­å€¼æ˜¯å¦åœ¨ç¼“å­˜æ± ä¸­ï¼Œå¦‚æœåœ¨çš„è¯å°±ç›´æ¥è¿”å›ç¼“å­˜æ± çš„å†…å®¹ã€‚

```java
public static Integer valueOf(int i) {
    if (i >= IntegerCache.low && i <= IntegerCache.high)
        return IntegerCache.cache[i + (-IntegerCache.low)];
    return new Integer(i);
}
```
åœ¨ Java 8 ä¸­ï¼ŒInteger ç¼“å­˜æ± çš„å¤§å°é»˜è®¤ä¸º -128~127ã€‚

```java
static final int low = -128;
static final int high;
static final Integer cache[];

static {
    // high value may be configured by property
    int h = 127;
    String integerCacheHighPropValue =
        sun.misc.VM.getSavedProperty("java.lang.Integer.IntegerCache.high");
    if (integerCacheHighPropValue != null) {
        try {
            int i = parseInt(integerCacheHighPropValue);
            i = Math.max(i, 127);
            // Maximum array size is Integer.MAX_VALUE
            h = Math.min(i, Integer.MAX_VALUE - (-low) -1);
        } catch( NumberFormatException nfe) {
            // If the property cannot be parsed into an int, ignore it.
        }
    }
    high = h;

    cache = new Integer[(high - low) + 1];
    int j = low;
    for(int k = 0; k < cache.length; k++)
        cache[k] = new Integer(j++);

    // range [-128, 127] must be interned (JLS7 5.1.7)
    assert IntegerCache.high >= 127;
}
```


ç¼–è¯‘å™¨ä¼šåœ¨è‡ªåŠ¨è£…ç®±è¿‡ç¨‹è°ƒç”¨ `valueOf()` æ–¹æ³•ï¼Œå› æ­¤å¤šä¸ªå€¼ç›¸åŒä¸”å€¼åœ¨ç¼“å­˜æ± èŒƒå›´å†…çš„ Integer å®ä¾‹ä½¿ç”¨è‡ªåŠ¨è£…ç®±æ¥åˆ›å»ºï¼Œé‚£ä¹ˆå°±ä¼šå¼•ç”¨ç›¸åŒçš„å¯¹è±¡ã€‚

```java
Integer m = 1;
Integer n = 1;
System.out.println(m == n); // true
```
åŸºæœ¬ç±»å‹å¯¹åº”çš„ç¼“å†²æ± å¦‚ä¸‹ï¼š


- `boolean` values true and false
- all `byte` values
- `short` values between -128 and 127
- `int` values between -128 and 127
- `char` in the range \u0000 to \u007F

åœ¨ä½¿ç”¨è¿™äº›åŸºæœ¬ç±»å‹å¯¹åº”çš„åŒ…è£…ç±»å‹æ—¶ï¼Œå¦‚æœè¯¥æ•°å€¼èŒƒå›´åœ¨ç¼“å†²æ± èŒƒå›´å†…ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ç¼“å†²æ± ä¸­çš„å¯¹è±¡ã€‚

åœ¨ jdk 1.8 æ‰€æœ‰çš„æ•°å€¼ç±»ç¼“å†²æ± ä¸­ï¼ŒInteger çš„ç¼“å†²æ±  IntegerCache å¾ˆç‰¹æ®Šï¼Œè¿™ä¸ªç¼“å†²æ± çš„ä¸‹ç•Œæ˜¯ - 128ï¼Œä¸Šç•Œé»˜è®¤æ˜¯ 127ï¼Œä½†æ˜¯è¿™ä¸ªä¸Šç•Œæ˜¯å¯è°ƒçš„ï¼Œåœ¨å¯åŠ¨ jvm çš„æ—¶å€™ï¼Œé€šè¿‡ -XX:AutoBoxCacheMax=<size> æ¥æŒ‡å®šè¿™ä¸ªç¼“å†²æ± çš„å¤§å°ï¼Œè¯¥é€‰é¡¹åœ¨ JVM åˆå§‹åŒ–çš„æ—¶å€™ä¼šè®¾å®šä¸€ä¸ªåä¸º java.lang.IntegerCache.high ç³»ç»Ÿå±æ€§ï¼Œç„¶å IntegerCache åˆå§‹åŒ–çš„æ—¶å€™å°±ä¼šè¯»å–è¯¥ç³»ç»Ÿå±æ€§æ¥å†³å®šä¸Šç•Œã€‚

### ğŸ”¸ Integer.valueOf(1111)
ä¸Šé¢ä»‹ç»äº†valueOfçš„ç¼“å­˜å€¼èŒƒå›´ä¸º-128~127ï¼Œè€Œ1111è¶…å‡ºäº†è¿™ä¸ªèŒƒå›´ï¼Œæ‰€ä»¥`Integer i1 = Integer.valueOf(1111)`ç­‰ä»·äº`Integer i1 = new Integer(1111)`ã€‚
```java
@Test
public void test6() {
    Integer i1 = Integer.valueOf(1111);
    Integer i2 = Integer.valueOf(1111);
    Integer i3 = Integer.valueOf(1111);

    System.out.println(i1 == i2);  // false
    System.out.println(i1 == i3);  // false
    System.out.println(i2 == i3);  // false
}
```
å†…å­˜ä¸­æ˜¯è¿™æ ·ï¼Œi1 i2 i3æ˜¯3ä¸ªä¸åŒçš„å¯¹è±¡ã€‚