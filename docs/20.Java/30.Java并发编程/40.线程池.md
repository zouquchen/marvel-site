---
title: çº¿ç¨‹æ± 
date: 2022-07-13 16:28:42
permalink: /pages/3f9c2b/
categories:
  - Java
  - Javaå¹¶å‘ç¼–ç¨‹
tags:
  - Java
  - JUC
author: 
  name: Marvel
  link: https://github.com/zouquchen
---
# çº¿ç¨‹æ± 

## ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„

å¤„ç†è¿‡ç¨‹ä¸­å°†ä»»åŠ¡æ”¾å…¥é˜Ÿåˆ—ï¼Œå¦‚æœçº¿ç¨‹æ•°é‡è¶…è¿‡æœ€å¤§æ•°é‡ï¼Œè¶…å‡ºæ•°é‡çš„çº¿ç¨‹æ’é˜Ÿç­‰å€™ã€‚

çº¿ç¨‹å¤ç”¨ï¼Œæ§åˆ¶æœ€å¤§å¹¶å‘æ•°ï¼Œç®¡ç†çº¿ç¨‹ã€‚

- **é™ä½èµ„æºæ¶ˆè€—**ï¼Œé€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹ï¼Œé™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚
- **æ‰§è¡Œå“åº”é€Ÿåº¦å¿«**ï¼Œå½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚
- **æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§**ï¼Œçº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶çš„åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚

## Executorå¯åŠ¨çº¿ç¨‹çš„å¥½å¤„

é€šè¿‡Executoræ¥å¯åŠ¨çº¿ç¨‹æ¯”ä½¿ç”¨Threadçš„startæ–¹æ³•æ›´å¥½ï¼Œæ–¹ä¾¿ç®¡ç†ã€æ•ˆç‡é«˜ã€é¿å…thisé€ƒé€¸é—®é¢˜ã€‚

> thisé€ƒé€¸æ˜¯æŒ‡åœ¨æ„é€ å‡½æ•°è¿”å›ä¹‹å‰å…¶ä»–çº¿ç¨‹å°±æŒæœ‰è¯¥å¯¹è±¡çš„å¼•ç”¨ã€‚è°ƒç”¨å°šæœªæ„é€ å®Œå…¨çš„å¯¹è±¡çš„æ–¹æ³•å¯èƒ½å¼•å‘ä»¤äººç–‘æƒ‘çš„é”™è¯¯ã€‚

Executoræ¡†æ¶ä¸ä»…åŒ…æ‹¬çº¿ç¨‹æ± çš„ç®¡ç†ï¼Œè¿˜æä¾›çº¿ç¨‹å·¥å‚ã€é˜Ÿåˆ—ä»¥åŠæ‹’ç»ç­–ç•¥ç­‰ï¼ŒExecutoræ¡†æ¶è®©å¹¶å‘ç¼–ç¨‹æ›´ç®€å•ã€‚

## çº¿ç¨‹å®ç°ç±»ThreadPoolExectuorç±»ç®€å•ä»‹ç»

æä¾›å››ä¸ªæ„é€ æ–¹æ³•ï¼Œæ¥çœ‹çœ‹æœ€é•¿çš„æ„é€ æ–¹æ³•ï¼š

```java
/**
* ç”¨ç»™å®šçš„åˆå§‹å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ThreadPoolExecutorã€‚
*/
public ThreadPoolExecutor(int corePoolSize,//çº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹æ•°é‡
                          int maximumPoolSize,//çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°
                          long keepAliveTime,//å½“çº¿ç¨‹æ•°å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°æ—¶ï¼Œå¤šä½™çš„ç©ºé—²çº¿ç¨‹å­˜æ´»çš„æœ€é•¿æ—¶é—´
                          TimeUnit unit,//æ—¶é—´å•ä½
                          BlockingQueue<Runnable> workQueue,//ä»»åŠ¡é˜Ÿåˆ—ï¼Œç”¨æ¥å‚¨å­˜ç­‰å¾…æ‰§è¡Œä»»åŠ¡çš„é˜Ÿåˆ—
                          ThreadFactory threadFactory,//çº¿ç¨‹å·¥å‚ï¼Œç”¨æ¥åˆ›å»ºçº¿ç¨‹ï¼Œä¸€èˆ¬é»˜è®¤å³å¯
                          RejectedExecutionHandler handler//æ‹’ç»ç­–ç•¥ï¼Œå½“æäº¤çš„ä»»åŠ¡è¿‡å¤šè€Œä¸èƒ½åŠæ—¶å¤„ç†æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®šåˆ¶ç­–ç•¥æ¥å¤„ç†ä»»åŠ¡
                         ) {
    if (corePoolSize < 0 ||
        maximumPoolSize <= 0 ||
        maximumPoolSize < corePoolSize ||
        keepAliveTime < 0)
        throw new IllegalArgumentException();
    if (workQueue == null || threadFactory == null || handler == null)
        throw new NullPointerException();
    this.corePoolSize = corePoolSize;
    this.maximumPoolSize = maximumPoolSize;
    this.workQueue = workQueue;
    this.keepAliveTime = unit.toNanos(keepAliveTime);
    this.threadFactory = threadFactory;
    this.handler = handler;
}
```

**ä¸ƒå¤§å‚æ•°**

- corePoolSizeï¼šæ ¸å¿ƒçº¿ç¨‹æ•°é‡ï¼Œå®ƒçš„æ•°é‡å†³å®šäº†æ·»åŠ çš„ä»»åŠ¡æ˜¯å¼€è¾Ÿæ–°çš„çº¿ç¨‹å»æ‰§è¡Œï¼Œè¿˜æ˜¯æ”¾åˆ°workQueueä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚
- maximumPoolSizeï¼šæœ€å¤§çº¿ç¨‹æ•°é‡ï¼Œè¿™ä¸ªå‚æ•°ä¼šæ ¹æ®ä½ ä½¿ç”¨çš„workQueueä»»åŠ¡é˜Ÿåˆ—çš„ç±»å‹ï¼Œå†³å®šçº¿ç¨‹æ± ä¼šå¼€è¾Ÿçš„æœ€å¤§çº¿ç¨‹æ•°é‡ã€‚
- keepAliveTimeï¼šå½“å‰çº¿ç¨‹æ± ä¸­ç©ºé—²çº¿ç¨‹æ•°é‡è¶…è¿‡corePoolSizeæ—¶ï¼Œå¤šä½™çš„çº¿ç¨‹ä¼šå¤šé•¿æ—¶é—´å†…è¢«é”€æ¯ã€‚
- unitï¼škeepAliveTimeçš„å•ä½
- workQueueï¼šä»»åŠ¡é˜Ÿåˆ—ï¼Œç”¨æ¥å­˜å‚¨ç­‰å¾…æ‰§è¡Œä»»åŠ¡çš„é˜Ÿåˆ—ï¼›å®ƒä¸€èˆ¬åˆ†ä¸ºç›´æ¥æäº¤é˜Ÿåˆ—ã€æœ‰ç•Œä»»åŠ¡é˜Ÿåˆ—ã€æ— ç•Œä»»åŠ¡é˜Ÿåˆ—ã€ä¼˜å…ˆé˜Ÿåˆ—ã€‚
- threadFactoryï¼šçº¿ç¨‹å·¥å‚ï¼Œç”¨äºçº¿ç¨‹åˆ›å»ºï¼Œä¸€èˆ¬é»˜è®¤å³å¯ã€‚
- handlerï¼šæ‹’ç»ç­–ç•¥ï¼›å½“ä»»åŠ¡å¤ªå¤šæ¥ä¸åŠå¤„ç†æ—¶ï¼Œå¯ä»¥å®šåˆ¶ç­–ç•¥æ¥å¤„ç†ä»»åŠ¡ã€‚



## ThreadPoolExecutoræ ¸å¿ƒçº¿ç¨‹æ•°é‡å’Œæœ€å¤§çº¿ç¨‹æ•°é‡

- æäº¤çš„æ–°ä»»åŠ¡å°‘äºcorePoolSizeï¼Œå³ä½¿å…¶ä»–å·¥ä½œçº¿ç¨‹å¤„äºç©ºé—²çŠ¶æ€ï¼Œä¹Ÿä¼šåˆ›å»ºæ–°çº¿ç¨‹å¤„ç†ã€‚

- æäº¤çš„æ–°ä»»åŠ¡å¤§äºcorePoolSizeï¼Œå°äºmaximumPoolSizeï¼Œåªæœ‰å½“é˜Ÿåˆ—å·²æ»¡æ—¶æ‰ä¼šåˆ›å»ºæ–°çº¿ç¨‹
- é€šè¿‡è®¾ç½®corePoolSizeå’ŒmaximumPoolSizeç›¸åŒï¼Œå¯ä»¥åˆ›å»ºå›ºå®šå¤§å°çš„çº¿ç¨‹æ± ã€‚
- å°†maximumPoolSizeè®¾ç½®ä¸ºInteger.MAX_VALUEï¼Œå¯ä»¥å®¹çº³ä»»æ„æ•°é‡çš„å¹¶å‘æ•°é‡ã€‚
- å¯ä»¥ä½¿ç”¨setCorePoolSizeå’ŒsetMaximumSizeè¿›è¡ŒåŠ¨æ€æ›´æ”¹ã€‚

![img](https://raw.githubusercontent.com/zouquchen/Images/main/imgs/%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%B7%A5%E4%BD%9C%E6%96%B9%E5%BC%8F2.webp)



## çº¿ç¨‹æ± çš„åº•å±‚å·¥ä½œåŸç†

1 æäº¤ä»»åŠ¡åï¼Œå¦‚æœæ ¸å¿ƒçº¿ç¨‹æ•°é‡æ²¡æœ‰æ»¡ï¼Œåˆ™åˆ›å»ºæ–°çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ã€‚

2 æäº¤ä»»åŠ¡åï¼Œå¦‚æœæ ¸å¿ƒçº¿ç¨‹æ•°é‡å·²æ»¡ï¼Œåˆ™å°†ä»»åŠ¡æ”¾å…¥ç­‰å¾…é˜Ÿåˆ—ã€‚

3 å½“ç­‰å¾…é˜Ÿåˆ—å·²æ»¡æ—¶ï¼Œä¸”æ²¡æœ‰è¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°é‡ï¼Œåˆ™åˆ›å»ºæ–°çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ã€‚

4 å½“ç­‰å¾…é˜Ÿåˆ—å·²æ»¡æ—¶ï¼Œä¸”è¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°é‡æ—¶ï¼Œæ–°æäº¤ä»»åŠ¡å°†è¢«æ‹’ç»ã€‚

5 å½“é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•æ—¶ï¼Œç©ºé—²çº¿ç¨‹ç©ºé—²çš„æ—¶é—´è¶…è¿‡keepAliveTimeï¼Œåˆ™å…³é—­ç©ºé—²çº¿ç¨‹ã€‚ï¼ˆè¶…è¿‡æ ¸å¿ƒæ•°é‡çš„çº¿ç¨‹ä¸ºç©ºé—²çº¿ç¨‹ï¼‰

<img src="https://raw.githubusercontent.com/zouquchen/Images/main/imgs/%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%B7%A5%E4%BD%9C%E6%96%B9%E5%BC%8F.png" alt="image-20220617201738576" style="zoom:80%;" />

## çº¿ç¨‹æ•°é‡çš„é€‰æ‹©ï¼Ÿ

é¦–å…ˆæŸ¥çœ‹CPUæ ¸å¿ƒæ•°é‡ï¼š

```java
System.out.println(Runtime.getRuntime().availableProcessors());
```

ğŸ“Œ **CPUå¯†é›†å‹**

CPUå¯†é›†å‹ä»»åŠ¡é…ç½®å°½å¯èƒ½å°‘çš„çº¿ç¨‹æ•°é‡ï¼Œä¸€èˆ¬ï¼šCPUæ ¸æ•° + 1ä¸ªçº¿ç¨‹ çš„çº¿ç¨‹æ± 

ğŸ“Œ **IOå¯†é›†å‹**

ç”±äºIOå¯†é›†å‹ä»»åŠ¡çº¿ç¨‹å¹¶ä¸æ˜¯ä¸€ç›´åœ¨æ‰§è¡Œä»»åŠ¡ï¼Œåˆ™åº”é…ç½®å°½å¯èƒ½å¤šçš„çº¿ç¨‹

ï¼ˆ1ï¼‰CPUæ ¸æ•°*2

ï¼ˆ2ï¼‰CPUæ ¸æ•° / (1 - é˜»å¡ç³»æ•°)ï¼Œé˜»å¡ç³»æ•°åœ¨0.8~0.9ä¹‹é—´

## ThreadPoolExecutoræ‹’ç»ç­–ç•¥

é˜Ÿåˆ—å·²æ»¡ä¸”çº¿ç¨‹æ± åˆ›å»ºçš„çº¿ç¨‹æ•°é‡è¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°æ—¶ï¼Œéœ€è¦æŒ‡å®šæ‹’ç»ç­–ç•¥æ¥å¤„ç†çº¿ç¨‹æ± è¶…è½½çš„æƒ…å†µã€‚

1. AbortPolicyç­–ç•¥ï¼ˆé»˜è®¤ï¼‰ï¼šç›´æ¥æŠ›å‡ºRejectedExecutionExceptionå¼‚å¸¸ï¼Œé˜»æ­¢ç³»ç»Ÿæ­£å¸¸è¿è¡Œã€‚
2. CallerRunsPolicyç­–ç•¥ï¼šå¦‚æœçº¿ç¨‹æ± çš„çº¿ç¨‹æ•°é‡è¾¾åˆ°ä¸Šé™ï¼Œè¯¥ç­–ç•¥ä¼šæŠŠä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡æ”¾åœ¨è°ƒç”¨è€…çº¿ç¨‹å½“ä¸­è¿è¡Œã€‚
3. DiscardOldestPolicyç­–ç•¥ï¼šæŠ›å¼ƒé˜Ÿåˆ—ä¸­ç­‰å¾…æœ€ä¹…çš„ä»»åŠ¡ï¼Œç„¶åæŠŠå½“å‰ä»»åŠ¡åŠ å…¥é˜Ÿåˆ—ä¸­å°è¯•å†æ¬¡æäº¤å½“å‰ä»»åŠ¡ã€‚
4. DiscardPolicyç­–ç•¥ï¼šç›´æ¥ä¸¢å¼ƒä»»åŠ¡ã€‚



##  è‡ªå®šä¹‰åˆ›å»ºçº¿ç¨‹æ± 

```java
ExecutorService threadPool = new ThreadPoolExecutor(
        2,
        5,
        1L,
        TimeUnit.SECONDS,
        new LinkedBlockingDeque<>(3),
        Executors.defaultThreadFactory(),
        new ThreadPoolExecutor.AbortPolicy());
```



## ä¸‰ç§åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹æ³•ï¼Ÿ

â­ **newFixedThreadPool**

ç‰¹ç‚¹ï¼šæ‰§è¡Œé•¿æœŸçš„ä»»åŠ¡ï¼Œæ€§èƒ½å¥½å¾ˆå¤š

å›ºå®šçº¿ç¨‹æ•°çš„çº¿ç¨‹æ± ï¼ŒcorePoolSizeå’ŒmaximumPoolSizeå€¼ç›¸åŒï¼ŒkeepAliveTImeä¸º0ï¼Œç­‰å¾…é˜Ÿåˆ—ä¸ºLinkedBlockingQueue

```java
public static ExecutorService newFixedThreadPool(int nThreads) {
    return new ThreadPoolExecutor(nThreads, nThreads, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue<Runnable>());
}
```

â­ **newSingleThreadExecutor**

ç‰¹ç‚¹ï¼šä¸€ä¸ªä»»åŠ¡ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œçš„åœºæ™¯

corePoolSizeå’ŒmaximumPoolSizeå€¼å‡ä¸º1ï¼Œå…¶ä»–å‚æ•°ä¸FixedThreadPoolç›¸åŒã€‚

```java
public static ExecutorService newSingleThreadExecutor() {
    return new FinalizableDelegatedExecutorService
        (new ThreadPoolExecutor(1, 1, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue<Runnable>()));
}
```

â­ **newCachedThreadPoolPool**

ç‰¹ç‚¹ï¼šæ‰§è¡Œå¾ˆå¤šçŸ­æœŸå¼‚æ­¥çš„å°ç¨‹åºæˆ–è€…è´Ÿè½½è¾ƒè½»çš„æœåŠ¡å™¨

corePoolSizeä¸º0ï¼ŒmaximumPoolSizeä¸ºInteger.MAX_VALUEï¼ŒKeepAliveTimeä¸º60Lï¼Œä½¿ç”¨æ— å®¹é‡çš„SynchronousQueueä½œä¸ºé˜Ÿåˆ—ã€‚

```java
public static ExecutorService newCachedThreadPool() {
    return new ThreadPoolExecutor(0, Integer.MAX_VALUE, 60L, TimeUnit.SECONDS, new SynchronousQueue<Runnable>());
}
```

æ¡ˆä¾‹ï¼š

```java
public class ThreadPoolDemo {
    public static void main(String[] args) {
        // ä¸€æ± 5ä¸ªå¤„ç†çº¿ç¨‹
        ExecutorService threadPool = Executors.newFixedThreadPool(5);
        // ä¸€æ± 1ä¸ªå¤„ç†çº¿ç¨‹
        // ExecutorService threadPool = Executors.newFixedThreadPool(5);
        // ä¸€æ± Nä¸ªå¤„ç†çº¿ç¨‹
        // ExecutorService threadPool = Executors.newCachedThreadPool();

        try {
            for (int i = 0; i < 20; i++) {
                threadPool.execute(() -> {
                    System.out.println(Thread.currentThread().getName() + "\t å¤„ç†ä¸šåŠ¡");
                });
            }
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            threadPool.shutdown();
        }
    }
}
```

å­˜åœ¨é—®é¢˜ï¼šé˜»å¡é˜Ÿåˆ—ä½¿ç”¨LinkedBlockingQueueï¼Œå…è®¸è¯·æ±‚é˜Ÿåˆ—é•¿åº¦ä¸ºInteger.MAX_VALUEï¼Œå¯èƒ½ä¼šå †ç§¯å¤§é‡çš„è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´OOMã€‚



## ä»‹ç»ä¸€ä¸‹é˜»å¡é˜Ÿåˆ—BlockingQueueï¼Ÿ

å½“é˜»å¡é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œä»é˜Ÿåˆ—ä¸­**è·å–**å…ƒç´ çš„æ“ä½œå°†è¢«é˜»å¡ã€‚

å½“ç»„è®¾é˜Ÿåˆ—ä¸ºæ»¡æ—¶ï¼Œå¾€é˜Ÿåˆ—é‡Œ**æ·»åŠ **å…ƒç´ çš„æ“ä½œå°†è¢«é˜»å¡ã€‚

<img src="E:\æ‰¾å·¥ä½œ\4-å¹¶å‘ç¼–ç¨‹.assets\image-20220615215313234.png" alt="image-20220615215313234" style="zoom: 33%;" />

è¯•å›¾ä»ç©ºçš„é˜»å¡é˜Ÿåˆ—ä¸­è·å–å…ƒç´ çš„çº¿ç¨‹å°†ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°å…¶ä»–çš„çº¿ç¨‹å¾€ç©ºçš„é˜Ÿåˆ—æ’å…¥æ–°çš„å…ƒç´ ã€‚

è¯•å›¾å¾€å·²æ»¡çš„é˜»å¡é˜Ÿåˆ—ä¸­æ·»åŠ æ–°çš„å…ƒç´ çš„çº¿ç¨‹å°†ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°å…¶ä»–çš„çº¿ç¨‹ä»é˜Ÿåˆ—ä¸­ç§»é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ ã€‚

å…·æœ‰ä»¥ä¸‹å®ç°ç±»ï¼š

- â­ArrayBlockingQueueï¼šç”±æ•°ç»„ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œæ„é€ æ—¶éœ€è¦æŒ‡æ˜å¤§å°ï¼ŒFIFOã€‚
- â­LinkedBlockingQueueï¼šç”±é“¾è¡¨ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ï¼ˆé»˜è®¤å¤§å°Integer.MAX_VALUEï¼Œæœ‰ç•Œä½†ç­‰åŒäºæ— ç•Œï¼‰ï¼Œå¯æŒ‡æ˜å¤§å°ï¼Œä¹Ÿå¯ä¸æŒ‡æ˜å¤§å°ï¼ŒFIFOã€‚
- PriorityBlockingQueueï¼šæ”¯æŒä¼˜å…ˆçº§æ’åºçš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œä¾æ®å¯¹è±¡çš„è‡ªç„¶æ’åºé¡ºåºæˆ–è€…æ„é€ å‡½æ•°æ‰€å¸¦çš„Comapratorå†³å®šé¡ºåºã€‚
- DelayQueueï¼šä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—å®ç°çš„å»¶è¿Ÿæ— è§£é˜»å¡é˜Ÿåˆ—ã€‚
- â­SynchronousQueueï¼šä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ï¼Œä¹Ÿå³å•ä¸ªå…ƒç´ çš„é˜Ÿåˆ—ï¼Œå¯¹é½çš„æ“ä½œå¿…é¡»æ˜¯æ”¾å’Œå–äº¤æ›¿å®Œæˆã€‚
- LinkedTransferQueueï¼šç”±é“¾è¡¨ç»“æ„ç»„æˆçš„æ— ç•Œé˜»å¡é˜Ÿåˆ—
- LinkedBlockingDequeï¼šç”±é“¾è¡¨ç»“æ„ç»„æˆçš„åŒå‘é˜»å¡é˜Ÿåˆ—



## ä¸ºä»€ä¹ˆéœ€è¦é˜»å¡é˜Ÿåˆ—ï¼Ÿ

ä¸éœ€è¦å…³å¿ƒä»€ä¹ˆæ—¶å€™éœ€è¦é˜»å¡çº¿ç¨‹ï¼Œä»€ä¹ˆæ—¶å€™å”¤é†’çº¿ç¨‹ï¼Œå› ä¸ºè¿™ä¸€åˆ‡BlockingQueueéƒ½å¸®æˆ‘ä»¬è§£å†³äº†ã€‚

> åœ¨JUCåŒ…å‘å¸ƒä¹‹å‰ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œæ¯ä¸ªç¨‹åºå‘˜éƒ½å¿…é¡»è‡ªå·±æ§åˆ¶è¿™äº›ç»†èŠ‚ã€‚



## é˜»å¡é˜Ÿåˆ—æ“ä½œè¯¦è§£

![image-20220616193740260](https://raw.githubusercontent.com/zouquchen/Images/main/imgs/%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97%E6%93%8D%E4%BD%9CAPI.png)

æŠ›å‡ºå¼‚å¸¸ï¼ˆThrows exceptionï¼‰ï¼š

- é˜Ÿåˆ—æ»¡æ—¶ï¼Œå†addæ’å…¥å…ƒç´ ä¼šæŠ›å‡ºå¼‚å¸¸`IllegalStateException: Queue full`
- é˜Ÿåˆ—ç©ºæ—¶ï¼Œå†removeæº¢å‡ºå…ƒç´ ä¼šæŠ›å‡ºå¼‚å¸¸`NoSuchElementException`

ç‰¹æ®Šå€¼ï¼ˆSpecial Valueï¼‰ï¼š

- æ’å…¥offeræ–¹æ³•ï¼ŒæˆåŠŸtrueï¼Œå¤±è´¥false
- ç§»é™¤pollæ–¹æ³•ï¼ŒæˆåŠŸè¿”å›å…ƒç´ ï¼Œå¤±è´¥è¿”å›null

é˜»å¡ï¼ˆBlocksï¼‰

- é˜Ÿåˆ—æ»¡æ—¶ï¼Œç”Ÿäº§è€…çº¿ç¨‹putå…ƒç´ ï¼Œé˜Ÿåˆ—ä¼šä¸€ç›´é˜»å¡ç”Ÿäº§çº¿ç¨‹çŸ¥é“putæ•°æ®æˆåŠŸã€‚
- é˜Ÿåˆ—ç©ºæ—¶ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹takeå…ƒç´ ï¼Œé˜Ÿåˆ—ä¼šä¸€ç›´é˜»å¡æ¶ˆè´¹è€…çº¿ç¨‹çŸ¥é“é˜Ÿåˆ—æœ‰å¯ç”¨å…ƒç´ ã€‚

è¶…æ—¶é€€å‡ºï¼ˆTimes outï¼‰

- é˜Ÿåˆ—æ»¡æ—¶ï¼Œæ·»åŠ å…ƒç´ ä¼šé˜»å¡çº¿ç¨‹ä¸€å®šæ—¶é—´ï¼Œè¶…è¿‡æ—¶é—´åç”Ÿäº§è€…çº¿ç¨‹ä¼šé€€å‡ºè¿”å›falseã€‚
- é˜Ÿåˆ—ç©ºæ—¶ï¼Œè·å–å…ƒç´ ä¼šç»„è®¾çº¿ç¨‹ä¸€å®šæ—¶é—´ï¼Œè¶…è¿‡æ—¶é—´åæ¶ˆè´¹è€…çº¿ç¨‹ä¼šé€€å‡ºè¿”å›falseã€‚
